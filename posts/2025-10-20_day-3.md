---
title: "Day 3: Exploring the SNP-Seek Database Schema and Data Loading Workflow"
description: Examines the core structure and relationships within the SNP-Seek database and demonstrates how genomic data are loaded into the system.
authorId: "dags"
published: "2025-10-20"
---

# SNP-Seek Database Schema

_In progress_

# Data Loading Workflow

The data for loading was generated in the preceding section. There are **two ways to load data**: either through a **user interface built with Java Swing** or by **running a script**.

## 1. Genotype Loader (Java Swing)

The loader is implemented in **Java** and provides a graphical user interface for loading genomic data into the database.

### Repository Information

The loader is available in the following Bitbucket repository:
ðŸ”— **https://bitbucket.org/dagsbarboza/genotypeloader/**

It depends on the **chadomodel** library, which can be found here:
ðŸ”— **https://bitbucket.org/dagsbarboza/chadomodel/**

### Prerequisite

- Java JDK version 1.8

<!-- ! Add installation instructions -->

### Running the Loader

To run the loader UI, execute the `GenotypeLoaderUI2.java` file.

### Input Files Required

1. **Genotype HDF5 file**
2. **Sample list with Sample IDs** - A file containing the list of samples.

   The sample list should contain sample names in the same order as they appear in the matrix generation.

   ![Example of sample list](public/assets/day-3/sample-list-example.png)

3. **SNP positions** - Genomic positions of the SNPs

   ![Example of SNP positions](public/assets/day-3/snp-positions-example.png)

### The Loader UI

![Screenshot of the Loader UI](public/assets/day-3/genotype-loader-screenshot.png)

## 2. Bulk Loading Script

This script automates the **bulk loading of genomic variant and sample data** into a PostgreSQL-based Chado schema (or similar database structure).

The bulk loading script performs the following tasks:

- Validates input files (sample, pos, and HDF5 filename)
- Looks up or inserts CV terms, organism, and database references if they do not exist
- Generates required CSV files:
  - `StockSample.csv`
  - `SampleVarietySet.csv`
  - `SnpFeature.csv`
  - `Variant_variantset.csv`
  - `Snp_FeatureLoc.csv`
- Updates sequence values for related tables to prevent ID conflicts
- Inserts new records into stock, dbxref, variantset, platform, and genotype_run tables
- Performs bulk copy (`\copy`) of the generated CSVs into their respective database tables

This approach ensures **consistency of metadata** (stocks, samples, SNP features, etc.) and **speeds up the ingestion** of large datasets.

### Repository and Setup

The script can be found in the following repository:
ðŸ”— **https://github.com/1K1RG/1k1RG-Scripts.git**

**Clone the Repository**

```bash
git clone https://github.com/1K1RG/1k1RG-Scripts.git
```

Navigate to the appropriate directory containing `bulk_load.sh`.

### Prerequisites

- **PostgreSQL client** (`psql`) installed
- **Database credentials** and permissions to insert data
- **Input files**:
  - Sample file â†’ list of sample names
  - POS file â†’ tab-delimited file with chromosome and SNP positions
  - H5 file name â†’ identifier for the HDF5 dataset
- **Script execution permission**:

```bash
chmod +x bulk_load.sh
```

### Usage

`./bulk_load.sh <DB_NAME> <DB_USER> <DB_HOST> <DB_PORT> <DB_PASSWORD> <SAMPLE_FILE> <POS_FILE> <H5_FILE_NAME>`

#### Example

```bash
./bulk_load.sh genodb admin localhost 5432 secret samples.txt positions.txt data.h5
```

#### Parameters

| **Parameter**  | **Description**                                      |
| -------------- | ---------------------------------------------------- |
| `DB_NAME`      | Name of the target database                          |
| `DB_USER`      | Database username                                    |
| `DB_HOST`      | Database hostname (e.g., localhost)                  |
| `DB_PORT`      | Database port (default: 5432)                        |
| `DB_PASSWORD`  | Password for the database user                       |
| `SAMPLE_FILE`  | Path to the sample file (list of stock/sample names) |
| `POS_FILE`     | Path to the SNP position file                        |
| `H5_FILE_NAME` | Name/identifier of the HDF5 genotype dataset         |

### Expected Outcome

After successful execution, the **sample, SNP, and variant data** will be fully inserted and linked in the database.
